åŸºäº React Native å’Œ React Native Web æ„å»ºä¸€ä¸ªç±»ä¼¼ Ant Design Mobile çš„è·¨ç«¯ç»„ä»¶åº“æ˜¯ä¸€é¡¹ç³»ç»Ÿå·¥ç¨‹ï¼Œéœ€è¦ç²¾å¿ƒè®¾è®¡æ¶æ„ã€å¤„ç†å¹³å°å·®å¼‚ï¼Œå¹¶ç¡®ä¿å¼€å‘ä½“éªŒã€‚ä¸‹é¢æ˜¯ä¸€å¥—å®Œæ•´çš„æŠ€æœ¯æ–¹æ¡ˆï¼Œå¸®åŠ©ä½ å¿«é€Ÿç†è§£å’Œå®æ–½ã€‚

# ğŸ§± è·¨ç«¯ç»„ä»¶åº“æŠ€æœ¯æ–¹æ¡ˆ

## ğŸ“‹ ç›®å½•
1.  **æ¶æ„è®¾è®¡**
2.  **æŠ€æœ¯é€‰å‹ä¸åˆå§‹åŒ–**
3.  **ç»„ä»¶è®¾è®¡ä¸å¼€å‘è§„èŒƒ**
4.  **æ ·å¼æ–¹æ¡ˆ**
5.  **è·¨å¹³å°é€‚é…ç­–ç•¥**
6.  **å·¥å…·é“¾ä¸æ„å»ºé…ç½®**
7.  **æ–‡æ¡£ä¸æµ‹è¯•**
8.  **å‘å¸ƒä¸éƒ¨ç½²**

## 1. æ¶æ„è®¾è®¡

æ„å»ºè·¨ç«¯ç»„ä»¶åº“çš„æ ¸å¿ƒæ˜¯**ä»£ç å¤ç”¨**å’Œ**å¹³å°é€‚é…**ã€‚

**æ ¸å¿ƒåŸåˆ™**ï¼š**ä¸€æ¬¡ç¼–å†™ï¼Œå¤šå¤„è¿è¡Œ**ã€‚å¤§éƒ¨åˆ†ç»„ä»¶é€»è¾‘å’Œæ ·å¼åº”èƒ½åœ¨ React Native (iOS/Android) å’Œ Web ä¸Šå…±äº«ã€‚
**åˆ†å±‚æ¶æ„**ï¼š
**åŸºç¡€ç»„ä»¶å±‚**ï¼šæä¾›æœ€åŸºç¡€çš„ UI æ„å»ºå—ï¼Œå¦‚ `Box` (View/div)ã€`Text` (Text/span)ã€‚è¿™äº›ç»„ä»¶éœ€è¦å¤„ç†æœ€æ ¸å¿ƒçš„å¹³å°å·®å¼‚ã€‚
**å¤åˆç»„ä»¶å±‚**ï¼šç”±åŸºç¡€ç»„ä»¶ç»„åˆè€Œæˆï¼Œå®ç°ç‰¹å®šåŠŸèƒ½ï¼Œå¦‚ `Button`ã€`Input`ã€`Tabs`ã€‚
**ä¸šåŠ¡ç»„ä»¶å±‚**ï¼ˆå¯é€‰ï¼‰ï¼šåŸºäºå¤åˆç»„ä»¶ï¼Œå°è£…æ›´å¤æ‚çš„ã€ä¸ä¸šåŠ¡é€»è¾‘ç›¸å…³çš„ç»„ä»¶ã€‚
**è·¨ç«¯å®ç°æ–¹æ¡ˆé€‰æ‹©**ï¼š
è¦å®ç° React Native ç»„ä»¶åœ¨ Web ä¸Šè¿è¡Œï¼Œä¸»è¦æœ‰å‡ ç§æ–¹æ¡ˆï¼Œå„æœ‰ä¼˜åŠ£ï¼š

| ç‰¹æ€§ | react-native-web (RNW) | react-strict-dom (RSD) | react-native-react-bridge (RNRB) | ä½ çš„ç»„ä»¶åº“ |
| :--- | :--- | :--- | :--- | :--- |
| **æ ¸å¿ƒæ€è·¯** | å°† RN API/ç»„ä»¶è½¬è¯‘ä¸º DOM | ç”¨ Web API æ¸²æŸ“ï¼ŒPolyfill åˆ° RN | WebView ä½œä¸ºæ¡¥æ¢ï¼ŒWeb å’Œ RN é€šä¿¡ | **åŸºäº RNWï¼Œæ¸è¿›å¼æ¢ç´¢ RSD** |
| **æ€§èƒ½** | è¾ƒå¥½ | **ç†è®ºä¸Šæ›´ä¼˜** | å— WebView æ€§èƒ½é™åˆ¶ | ä¼˜å…ˆä¿è¯ RNW æ€§èƒ½ |
| **å¼€å‘ä½“éªŒ** | å­¦ä¹  RN è¯­æ³• | **å­¦ä¹  Web è¯­æ³•** | éœ€å¤„ç†ä¸¤ç«¯é€šä¿¡ | **ç»Ÿä¸€çš„ RN è¯­æ³•** |
| **åŒ…å¤§å°** | è¾ƒå¤§ | **è¾ƒå°** | éœ€é›†æˆ Web åº”ç”¨ | ä¾èµ– RNWï¼Œéœ€ä¼˜åŒ– |
| **é€‚ç”¨åœºæ™¯** | æˆç†Ÿçš„è·¨ç«¯é¡¹ç›® | **Meta æ–°æ ‡å‡†ï¼Œæœªæ¥è¶‹åŠ¿** | é›†æˆç°æœ‰ Web åº”ç”¨ | **æ–°å»ºç»„ä»¶åº“ï¼Œè¿½æ±‚æœªæ¥å…¼å®¹** |

**æ¨èé€‰æ‹©**: **`react-native-web` (RNW)**ã€‚è¿™æ˜¯ä¸€ä¸ªä¹…ç»è€ƒéªŒã€å¹¿æ³›ä½¿ç”¨çš„æ–¹æ¡ˆï¼Œä¹Ÿæ˜¯ Ant Design Mobile RN ä½¿ç”¨çš„æŠ€æœ¯ã€‚å®ƒèƒ½å°† React Native çš„ç»„ä»¶å’Œ API æ˜ å°„åˆ° Web çš„ DOM å’Œ CSSï¼Œæ˜¯å®ç°è·¨ç«¯æœ€ç›´æ¥å’Œç¨³å®šçš„æ–¹å¼ã€‚åŒæ—¶ï¼Œå¯ä»¥å¯†åˆ‡å…³æ³¨ Meta æ–°å¼€æºçš„ `react-strict-dom`ï¼Œå®ƒä»£è¡¨äº†å¦ä¸€ç§è®¾è®¡æ€è·¯å’Œæœªæ¥çš„å¯èƒ½æ€§ã€‚

## 2. æŠ€æœ¯é€‰å‹ä¸åˆå§‹åŒ–

**æ ¸å¿ƒä¾èµ–**:
```bash
# åœ¨ä½ çš„ç»„ä»¶åº“é¡¹ç›®ä¸­
pnpm add react react-native --save # Peer Dependencies
pnpm add react-native-web --save # è·¨ç«¯æ ¸å¿ƒ
pnpm add react-dom --save-dev # ç”¨äº Web ç«¯ç¤ºä¾‹å’Œæ–‡æ¡£å¼€å‘
```
**æ„å»ºå·¥å…·**: æ¨èä½¿ç”¨ **TypeScript** ä»¥è·å¾—æ›´å¥½çš„ç±»å‹å®‰å…¨å’Œå¼€å‘ä½“éªŒã€‚
```bash
pnpm add typescript @types/react @types/react-native --save-dev
```
**åˆå§‹åŒ–é¡¹ç›®ç»“æ„**:
```
your-component-lib/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ Button/
â”‚   â”‚   â”‚   â”œâ”€â”€ index.tsx    # ä¸»ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ style.ts     # æ ·å¼
â”‚   â”‚   â”‚   â””â”€â”€ __tests__/   # æµ‹è¯•
â”‚   â”‚   â”œâ”€â”€ Tabs/
â”‚   â”‚   â””â”€â”€ index.ts         # ç»Ÿä¸€å¯¼å‡ºæ‰€æœ‰ç»„ä»¶
â”‚   â””â”€â”€ styles/
â”‚       â””â”€â”€ theme.ts         # è®¾è®¡ tokenï¼ˆé¢œè‰²ã€é—´è·ã€å­—ä½“ç­‰ï¼‰
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ index.html           # æ–‡æ¡£ç½‘ç«™å…¥å£
â”œâ”€â”€ example/                 # ç¤ºä¾‹é¡¹ç›®ï¼ˆRN å’Œ Webï¼‰
â”œâ”€â”€ package.json
â””â”€â”€ tsconfig.json
```

## 3. ç»„ä»¶è®¾è®¡è§„èŒƒ

**ç»Ÿä¸€æ¥å£**: ç»„ä»¶çš„ Props è®¾è®¡åº”å°½å¯èƒ½ä¿æŒä¸€è‡´ï¼Œå‡å°‘å¹³å°ç‰¹å®šä»£ç ã€‚
**ç»„ä»¶è®¾è®¡æ¨¡å¼ï¼ˆä»¥ Tabs ä¸ºä¾‹ï¼‰**:
```tsx
// src/components/Tabs/index.tsx
import React from 'react';
import { View, Text, ScrollView, type ViewProps } from 'react-native';
import { useComponentStyles } from '../../hooks'; // è‡ªå®šä¹‰ Hookï¼Œå¤„ç†æ ·å¼

export interface TabItem {
  key: string;
  title: string;
  content: React.ReactNode;
}

export interface TabsProps extends ViewProps {
  items: TabItem[];
  activeKey?: string;
  onChange?: (key: string) => void;
}

const Tabs = ({ items, activeKey, onChange, style, ...restProps }: TabsProps) => {
  const componentStyles = useComponentStyles('Tabs', style); // è·å–å¤„ç†åçš„æ ·å¼

  return (
    <View style={[componentStyles.container, style]} {...restProps}>
      <ScrollView horizontal showsHorizontalScrollIndicator={false} style={componentStyles.tabBar}>
        {items.map((item) => (
          <Text
            key={item.key}
            style={[
              componentStyles.tab,
              activeKey === item.key && componentStyles.activeTab
            ]}
            onPress={() => onChange?.(item.key)}
          >
            {item.title}
          </Text>
        ))}
      </ScrollView>
      <View style={componentStyles.content}>
        {items.find((item) => item.key === activeKey)?.content}
      </View>
    </View>
  );
};

export default Tabs;
```
**ç±»å‹å®šä¹‰**: ä½¿ç”¨ TypeScript ä¸¥æ ¼å®šä¹‰ Props å’ŒçŠ¶æ€ã€‚

## 4. æ ·å¼æ–¹æ¡ˆ

è·¨ç«¯æ ·å¼å¤„ç†æ˜¯å…³é”®æŒ‘æˆ˜ã€‚

**æ ¸å¿ƒæ–¹æ³•**: ä½¿ç”¨ `StyleSheet.create` (RN) å’Œ CSS (Web) çš„æŠ½è±¡å±‚ã€‚
```tsx
// src/components/Tabs/style.ts
import { StyleSheet } from 'react-native';

export const defaultTabsStyles = StyleSheet.create({
  container: {
    flex: 1,
    width: '100%',
  },
  tabBar: {
    flexDirection: 'row',
    borderBottomWidth: 1,
    borderBottomColor: '#f0f0f0',
  },
  tab: {
    paddingHorizontal: 16,
    paddingVertical: 8,
    fontSize: 14,
  },
  activeTab: {
    color: '#1890ff',
    borderBottomWidth: 2,
    borderBottomColor: '#1890ff',
  },
  content: {
    flex: 1,
    padding: 16,
  },
});
```
**æ ·å¼æ³¨å…¥ä¸é€‚é…**: åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰ Hook (`useComponentStyles`) æ¥å¤„ç†æ ·å¼çš„åˆå¹¶å’Œå¹³å°å·®å¼‚ï¼š
```tsx
// src/hooks/useComponentStyles.ts
import { useMemo } from 'react';
import { StyleSheet, type StyleProp } from 'react-native';

export const useComponentStyles = (componentName: string, style?: StyleProp<any>) => {
  return useMemo(() => {
    // è¿™é‡Œå¯ä»¥æ ¹æ® componentName è·å–é»˜è®¤æ ·å¼ï¼Œå¹¶åˆå¹¶ä¼ å…¥çš„ style
    const defaultStyles = {
      Tabs: { ... }, // å¯¼å…¥ä½ çš„é»˜è®¤æ ·å¼
      Button: { ... },
      // ... å…¶ä»–ç»„ä»¶
    };
    const componentDefaultStyles = defaultStyles[componentName] || {};
    return StyleSheet.flatten([componentDefaultStyles, style]);
  }, [componentName, style]);
};
```
**è®¾è®¡ Token**: å°†é¢œè‰²ã€å­—ä½“ã€é—´è·ç­‰å®šä¹‰ä¸ºå¸¸é‡ï¼Œç¡®ä¿å¤šç«¯ä¸€è‡´æ€§ã€‚
```tsx
// src/styles/theme.ts
export const theme = {
  colorPrimary: '#1890ff',
  colorText: '#333333',
  spacingSmall: 8,
  spacingMedium: 16,
  fontSizeBase: 14,
  // ... å…¶ä»– token
};
```

## 5. è·¨å¹³å°é€‚é…ç­–ç•¥

**å¹³å°æ£€æµ‹**: ä½¿ç”¨ `Platform.OS` å’Œ `Platform.select`ã€‚
```tsx
import { Platform } from 'react-native';

const styles = StyleSheet.create({
  container: {
    ...Platform.select({
      web: {
        cursor: 'pointer',
        userSelect: 'none',
      },
      default: {}
    })
  }
});
```
**æ¡ä»¶æ¸²æŸ“ä¸ç‰¹å®šå®ç°**:
å¯¹äºå·®å¼‚å·¨å¤§çš„ç»„ä»¶ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨ `.android.tsx`, `.ios.tsx`, `.web.tsx` åç¼€ï¼Œæ„å»ºå·¥å…·ä¼šè‡ªåŠ¨è¯†åˆ«ã€‚
æˆ–è€…åœ¨ä½¿ç”¨æ—¶æ¡ä»¶æ¸²æŸ“ï¼š
```tsx
const MyComponent = () => {
  if (Platform.OS === 'web') {
    return <WebSpecificComponent />;
  }
  return <NativeSpecificComponent />;
};
```
**å¤„ç† Web ç‰¹æœ‰å±æ€§**: åœ¨ Web ç«¯ï¼Œä½ å¯èƒ½éœ€è¦æ·»åŠ ä¸€äº› DOM å±æ€§ï¼ˆå¦‚ `data-testid`ï¼‰ã€‚
```tsx
const Tab = ({ title, testID }) => (
  <Text {...(Platform.OS === 'web' ? { 'data-testid': testID } : {})}>
    {title}
  </Text>
);
```

## 6. å·¥å…·é“¾ä¸æ„å»ºé…ç½®

**æ‰“åŒ…å·¥å…·**: ä½¿ç”¨ **Rollup** æˆ– **Webpack** æ‰“åŒ…ä½ çš„ç»„ä»¶åº“ã€‚
**Rollup** é€šå¸¸æ›´é€‚ç”¨äºåº“çš„æ‰“åŒ…ã€‚
é…ç½® `rollup.config.js`ï¼Œæ­£ç¡®å¤„ç† `react-native` åˆ° `react-native-web` çš„åˆ«åæ›¿æ¢ï¼š
```javascript
import resolve from '@rollup/plugin-node-resolve';
import commonjs from '@rollup/plugin-commonjs';
import typescript from '@rollup/plugin-typescript';
import peerDepsExternal from 'rollup-plugin-peer-deps-external';

export default {
  input: 'src/index.ts',
  output: [
    {
      file: 'dist/index.js',
      format: 'cjs',
    },
    {
      file: 'dist/index.esm.js',
      format: 'esm',
    },
  ],
  plugins: [
    peerDepsExternal(), // å°† peerDependencies å¤–éƒ¨åŒ–
    resolve({
      extensions: ['.js', '.jsx', '.ts', '.tsx'],
      // ä¸º Web æ„å»ºæ—¶ï¼Œå°† react-native æ›¿æ¢ä¸º react-native-web
      preferBuiltins: false,
      browser: true,
      dedupe: ['react-native', 'react', 'react-dom']
    }),
    commonjs(),
    typescript({ tsconfig: './tsconfig.json' }),
  ],
  external: ['react-native', 'react-native-web'] // ç¡®ä¿è¿™äº›åº“ä¸è¢«æ†ç»‘
};
```
**Babel é…ç½®**: åœ¨ `.babelrc` æˆ– `babel.config.js` ä¸­é…ç½® `react-native-web` æ’ä»¶ã€‚
```json
{
  "presets": ["module:metro-react-native-babel-preset"],
  "env": {
    "web": {
      "plugins": ["react-native-web"]
    }
  }
}
```

## 7. æ–‡æ¡£ä¸æµ‹è¯•

**æ–‡æ¡£å·¥å…·**: ä½¿ç”¨ **Storybook** æˆ– **Docusaurus**ã€‚Storybook éå¸¸é€‚åˆäº¤äº’å¼åœ°å¼€å‘å’Œå±•ç¤ºç»„ä»¶ã€‚
```bash
npx storybook@latest init
```
**ç¼–å†™ Stories** (ä»¥ Tabs ä¸ºä¾‹):
```tsx
// stories/Tabs.stories.tsx
import React from 'react';
import { Tabs } from '../src';

export default {
  title: 'Components/Tabs',
  component: Tabs,
};

const Template = (args) => <Tabs {...args} />;

export const Basic = Template.bind({});
Basic.args = {
  items: [
    { key: '1', title: 'Tab 1', content: <div>Content of Tab 1</div> },
    { key: '2', title: 'Tab 2', content: <div>Content of Tab 2</div> },
    { key: '3', title: 'Tab 3', content: <div>Content of Tab 3</div> },
  ],
  activeKey: '1',
};
```
**æµ‹è¯•**: ä½¿ç”¨ **Jest** å’Œ **React Testing Library** (æˆ– **@testing-library/react-native**) è¿›è¡Œå•å…ƒæµ‹è¯•å’Œäº¤äº’æµ‹è¯•ã€‚
```tsx
// src/components/Tabs/__tests__/index.test.tsx
import React from 'react';
import { render, fireEvent } from '@testing-library/react-native'; // æˆ– '@testing-library/react' for web
import Tabs from '../index';

describe('Tabs', () => {
  it('renders correctly', () => {
    const { getByText } = render(<Tabs items={[...]} />);
    expect(getByText('Tab 1')).toBeTruthy();
  });

  it('calls onChange when tab is clicked', () => {
    const mockOnChange = jest.fn();
    const { getByText } = render(<Tabs items={[...]} onChange={mockOnChange} />);
    fireEvent.press(getByText('Tab 2'));
    expect(mockOnChange).toHaveBeenCalledWith('2');
  });
});
```

## 8. å‘å¸ƒä¸éƒ¨ç½²

**npm å‘å¸ƒ**:
1.  è®¾ç½® `package.json` çš„ `main` (CJS), `module` (ESM), å’Œ `types` å­—æ®µæŒ‡å‘æ‰“åŒ…åçš„æ–‡ä»¶ã€‚
2.  `npm publish`
**æ–‡æ¡£éƒ¨ç½²**: å°† Storybook æˆ–æ–‡æ¡£ç½‘ç«™æ„å»ºä¸ºé™æ€æ–‡ä»¶ï¼Œéƒ¨ç½²åˆ° GitHub Pages, Netlify, Vercel ç­‰å¹³å°ã€‚
**ç‰ˆæœ¬ç®¡ç†**: éµå¾ªè¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶ (SemVer)ã€‚

---

æ„å»ºä¸€ä¸ªæˆç†Ÿçš„è·¨ç«¯ç»„ä»¶åº“éœ€è¦æŒç»­çš„è¿­ä»£å’Œä¼˜åŒ–ã€‚å¸Œæœ›è¿™ä»½æ–¹æ¡ˆèƒ½ä¸ºä½ æä¾›ä¸€ä¸ªæ¸…æ™°çš„èµ·ç‚¹ã€‚